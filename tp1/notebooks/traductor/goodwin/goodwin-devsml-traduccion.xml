<?xml version="1.0" encoding="utf-8"?>
<devs>
  <scenario>
    <coupled name="top" model="Coupled" >
      <!-- Input / Output -->
      <!-- Inputs -->
      <inputs>
        <port name="effectOfEmploymentRateInWages" />
        <port name="constantEmploymentRate" />
        <port name="alphaChgLaborProductivity" />
        <port name="betaChgPopulation" />
        <port name="velocityOfMoney" />
        <port name="rateOfAppreciation" />
        </inputs>
      <!-- Outputs -->
      <outputs>
        <port name="LaborProductivity" />
        <port name="wageRate" />
        <port name="Population" />
        <port name="Capital" />
        </outputs>
      <components>

        <!-- Stock : LaborProductivity -->
        <atomicRef name="ft LaborProductivity" model="Ftot">
          <!-- Puertos del atomico -->
          <port name="inPlus - chgLaborProductivity" type="in" />
          <port name="out" type="out" />
          <!-- State variables del atomico -->
          <parameter name="plus" value="0" />
          <parameter name="minus" value="0" /> 
        </atomicRef>
        <atomicRef name="LaborProductivity" model="QSS1">
          <parameter name="x0" value="1" />
          <parameter name="dQRel" value="1e-2" />
          <parameter name="dQMin" value="1e-4" />
        </atomicRef>
        <!-- Stock : wageRate -->
        <atomicRef name="ft wageRate" model="Ftot">
          <!-- Puertos del atomico -->
          <port name="inPlus - chgWageRate" type="in" />
          <port name="out" type="out" />
          <!-- State variables del atomico -->
          <parameter name="plus" value="0" />
          <parameter name="minus" value="0" /> 
        </atomicRef>
        <atomicRef name="wageRate" model="QSS1">
          <parameter name="x0" value="0.8" />
          <parameter name="dQRel" value="1e-2" />
          <parameter name="dQMin" value="1e-4" />
        </atomicRef>
        <!-- Stock : Population -->
        <atomicRef name="ft Population" model="Ftot">
          <!-- Puertos del atomico -->
          <port name="inPlus - chgPopulation" type="in" />
          <port name="out" type="out" />
          <!-- State variables del atomico -->
          <parameter name="plus" value="0" />
          <parameter name="minus" value="0" /> 
        </atomicRef>
        <atomicRef name="Population" model="QSS1">
          <parameter name="x0" value="150" />
          <parameter name="dQRel" value="1e-2" />
          <parameter name="dQMin" value="1e-4" />
        </atomicRef>
        <!-- Stock : Capital -->
        <atomicRef name="ft Capital" model="Ftot">
          <!-- Puertos del atomico -->
          <port name="inPlus - chgCapital" type="in" />
          <port name="out" type="out" />
          <!-- State variables del atomico -->
          <parameter name="plus" value="0" />
          <parameter name="minus" value="0" /> 
        </atomicRef>
        <atomicRef name="Capital" model="QSS1">
          <parameter name="x0" value="300" />
          <parameter name="dQRel" value="1e-2" />
          <parameter name="dQMin" value="1e-4" />
        </atomicRef>
        <!-- Flow : chgLaborProductivity -->
        <atomicRef name="fp LaborProductivity - chgLaborProductivity" model="Fplus">
          <!-- Puertos del atomico -->
          <port name="in LaborProductivity " type="in" />
          <port name="in  alphaChgLaborProductivity" type="in" />
          <port name="out" type="out" />
          <!-- Funcion usada en output function del atomico -->
          <parameter name="function" value="LaborProductivity * alphaChgLaborProductivity" />
        </atomicRef>
        <!-- Flow : chgPopulation -->
        <atomicRef name="fp Population - chgPopulation" model="Fplus">
          <!-- Puertos del atomico -->
          <port name="in Population " type="in" />
          <port name="in  betaChgPopulation" type="in" />
          <port name="out" type="out" />
          <!-- Funcion usada en output function del atomico -->
          <parameter name="function" value="Population * betaChgPopulation" />
        </atomicRef>
        <!-- Flow : chgWageRate -->
        <atomicRef name="fp wageRate - chgWageRate" model="Fplus">
          <!-- Puertos del atomico -->
          <port name="in wageFunction " type="in" />
          <port name="in  wageRate" type="in" />
          <port name="out" type="out" />
          <!-- Funcion usada en output function del atomico -->
          <parameter name="function" value="wageFunction * wageRate" />
        </atomicRef>
        <!-- Flow : chgCapital -->
        <atomicRef name="fp Capital - chgCapital" model="Fplus">
          <!-- Puertos del atomico -->
          <port name="in InvestmentNetReal" type="in" />
          <port name="out" type="out" />
          <!-- Funcion usada en output function del atomico -->
          <parameter name="function" value="InvestmentNetReal" />
        </atomicRef>
        <!-- Parameters / Constantes -->
        <atomicRef name="effectOfEmploymentRateInWages" model="Cte">
          <port name="inValue" type="in" />
          <port name="out" type="out" />
          <parameter name="value" value="10" />
        </atomicRef>
        <atomicRef name="constantEmploymentRate" model="Cte">
          <port name="inValue" type="in" />
          <port name="out" type="out" />
          <parameter name="value" value="0.6" />
        </atomicRef>
        <atomicRef name="alphaChgLaborProductivity" model="Cte">
          <port name="inValue" type="in" />
          <port name="out" type="out" />
          <parameter name="value" value="0.025" />
        </atomicRef>
        <atomicRef name="betaChgPopulation" model="Cte">
          <port name="inValue" type="in" />
          <port name="out" type="out" />
          <parameter name="value" value="0.015" />
        </atomicRef>
        <atomicRef name="velocityOfMoney" model="Cte">
          <port name="inValue" type="in" />
          <port name="out" type="out" />
          <parameter name="value" value="3" />
        </atomicRef>
        <atomicRef name="rateOfAppreciation" model="Cte">
          <port name="inValue" type="in" />
          <port name="out" type="out" />
          <parameter name="value" value="0" />
        </atomicRef>
        <!-- Parameters / Auxiliares -->
        <atomicRef name="wageFunction" model="Aux">
          <parameter name="function" value="(employmentRate - constantEmploymentRate) * effectOfEmploymentRateInWages" />
        </atomicRef>
        <atomicRef name="InvestmentGross" model="Aux">
          <parameter name="function" value="Profit" />
        </atomicRef>
        <atomicRef name="Profit" model="Aux">
          <parameter name="function" value="Output - wageBill" />
        </atomicRef>
        <atomicRef name="wageBill" model="Aux">
          <parameter name="function" value="wageRate * Labor" />
        </atomicRef>
        <atomicRef name="Labor" model="Aux">
          <parameter name="function" value="Output / LaborProductivity" />
        </atomicRef>
        <atomicRef name="Output" model="Aux">
          <parameter name="function" value="Capital / velocityOfMoney" />
        </atomicRef>
        <atomicRef name="omega" model="Aux">
          <parameter name="function" value="wageBill / Output" />
        </atomicRef>
        <atomicRef name="InvestmentNetReal" model="Aux">
          <parameter name="function" value="InvestmentGross - (Capital * rateOfAppreciation)" />
        </atomicRef>
        <atomicRef name="employmentRate" model="Aux">
          <parameter name="function" value="Labor / Population" />
        </atomicRef>
        </components>

      <internal_connections>

        <!-- Link : Cte's a f's que las usan -->
        <!-- Link : Cte's a Aux's que las usan -->
        <!-- Aux : wageFunction -->
        <connection component_from="effectOfEmploymentRateInWages" port_from="out" comonent_to="wageFunction" port_to="in effectOfEmploymentRateInWages"/>
        <!-- Aux : wageFunction -->
        <connection component_from="constantEmploymentRate" port_from="out" comonent_to="wageFunction" port_to="in constantEmploymentRate"/>
        <!-- Aux : Output -->
        <connection component_from="velocityOfMoney" port_from="out" comonent_to="Output" port_to="in velocityOfMoney"/>
        <!-- Aux : InvestmentNetReal -->
        <connection component_from="rateOfAppreciation" port_from="out" comonent_to="InvestmentNetReal" port_to="in rateOfAppreciation"/>
        <!-- Link : Aux a Aux's que las usan -->
        <!-- Aux : InvestmentGross => InvestmentNetReal-->
        <connection component_from="InvestmentGross" port_from="out" component_to="InvestmentNetReal" port_to="in InvestmentGross"/>
        <!-- Aux : Profit => InvestmentGross-->
        <connection component_from="Profit" port_from="out" component_to="InvestmentGross" port_to="in Profit"/>
        <!-- Aux : wageBill => Profit-->
        <connection component_from="wageBill" port_from="out" component_to="Profit" port_to="in wageBill"/>
        <!-- Aux : wageBill => omega-->
        <connection component_from="wageBill" port_from="out" component_to="omega" port_to="in wageBill"/>
        <!-- Aux : Labor => wageBill-->
        <connection component_from="Labor" port_from="out" component_to="wageBill" port_to="in Labor"/>
        <!-- Aux : Labor => Labor-->
        <connection component_from="Labor" port_from="out" component_to="Labor" port_to="in Labor"/>
        <!-- Aux : Labor => employmentRate-->
        <connection component_from="Labor" port_from="out" component_to="employmentRate" port_to="in Labor"/>
        <!-- Aux : Output => Profit-->
        <connection component_from="Output" port_from="out" component_to="Profit" port_to="in Output"/>
        <!-- Aux : Output => Labor-->
        <connection component_from="Output" port_from="out" component_to="Labor" port_to="in Output"/>
        <!-- Aux : Output => omega-->
        <connection component_from="Output" port_from="out" component_to="omega" port_to="in Output"/>
        <!-- Aux : employmentRate => wageFunction-->
        <connection component_from="employmentRate" port_from="out" component_to="wageFunction" port_to="in employmentRate"/>
        <!-- Link : Aux a funciones que las usan --> 
        <!-- Aux : wageFunction => chgWageRate -->
        <connection component_from="wageFunction" port_from="out" component_to="fp wageRate - chgWageRate" port_to="in - wageRate" />
        <!-- Aux : Labor => chgLaborProductivity -->
        <connection component_from="Labor" port_from="out" component_to="fp LaborProductivity - chgLaborProductivity" port_to="in - LaborProductivity" />
        <!-- Aux : InvestmentNetReal => chgCapital -->
        <connection component_from="InvestmentNetReal" port_from="out" component_to="fp Capital - chgCapital" port_to="in - Capital" />
        
        <!-- Links modelo acoplado minimal integrador LaborProductivity -->
        <connection component_from="fp LaborProductivity - chgLaborProductivity" port_from="out" component_to="ft LaborProductivity" port_to="inPlus - chgLaborProductivity" />
        <connection component_from="ft LaborProductivity" port_from="out" component_to="LaborProductivity" port_to="in" />
        <!-- Links modelo acoplado minimal integrador wageRate -->
        <connection component_from="fp wageRate - chgWageRate" port_from="out" component_to="ft wageRate" port_to="inPlus - chgWageRate" />
        <connection component_from="ft wageRate" port_from="out" component_to="wageRate" port_to="in" />
        <!-- Links modelo acoplado minimal integrador Population -->
        <connection component_from="fp Population - chgPopulation" port_from="out" component_to="ft Population" port_to="inPlus - chgPopulation" />
        <connection component_from="ft Population" port_from="out" component_to="Population" port_to="in" />
        <!-- Links modelo acoplado minimal integrador Capital -->
        <connection component_from="fp Capital - chgCapital" port_from="out" component_to="ft Capital" port_to="inPlus - chgCapital" />
        <connection component_from="ft Capital" port_from="out" component_to="Capital" port_to="in" />
        
        <!-- Links modelo (las flechas azules en el modelo grafico de SD) -->
        </internal_connections>
      
      <!-- Links inputs a constantes -->
      <!-- external input -->
      <external_input_connections>
        <connection component_from="top" port_from="in - effectOfEmploymentRateInWages" component_to="effectOfEmploymentRateInWages" port_to="inValue" />
        <connection component_from="top" port_from="in - constantEmploymentRate" component_to="constantEmploymentRate" port_to="inValue" />
        <connection component_from="top" port_from="in - alphaChgLaborProductivity" component_to="alphaChgLaborProductivity" port_to="inValue" />
        <connection component_from="top" port_from="in - betaChgPopulation" component_to="betaChgPopulation" port_to="inValue" />
        <connection component_from="top" port_from="in - velocityOfMoney" component_to="velocityOfMoney" port_to="inValue" />
        <connection component_from="top" port_from="in - rateOfAppreciation" component_to="rateOfAppreciation" port_to="inValue" />
        
      </external_input_connections>

      <!-- external output -->
      <external_output_connections />
    </coupled>
  </scenario>
</devs>